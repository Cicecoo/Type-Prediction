(base) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc[00m$ conda acivatre[K[Ke naturalcc
usage: conda [-h] [-v] [--no-plugins] [-V] COMMAND ...
conda: error: argument COMMAND: invalid choice: 'acivate' (choose from activate, build, clean, commands, compare, config, content-trust, convert, create, deactivate, debug, develop, doctor, env, export, index, info, init, inspect, install, list, metapackage, notices, pack, package, remove, rename, render, repo, repoquery, run, search, server, skeleton, token, tos, uninstall, update, upgrade)
(base) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc[00m$ conda acivate naturalcc[C[1@t
(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc[00m$ NCC
NCC: command not found
(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc[00m$ NCCcNCCaNCCtNCC NCC
cat: NCC: No such file or directory
(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc[00m$ cat NCC[C[C[1P NCC[1P NCC[1P NCCprintenv NCC
/mnt/data1/zhaojunzhang/typilus-data
(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc[00m$ printenv NCC[5Pcat[C[C[C[C[5@printenv[C[C[C[C[Kpython [K[K[K[K[K[K[Kcd /home/zhaojunzhang/workspace/type_pred/naturalcc/run/type_prediction/transformer
(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer[00m$ python [K[K[K[K[K[K[Kcd experiment_tools/
(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools[00m$ put[K[Kython run_experiments.py 

================================================================================
ÂÆûÈ™å: transformer_baseline
ÊèèËø∞: TransformerÂü∫Á∫ø - ‰ΩøÁî®token-sequence
================================================================================

ÈÖçÁΩÆÊñá‰ª∂: temp_configs/transformer_baseline_config.yml
ÂëΩ‰ª§: /mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/bin/python train_enhanced.py --config temp_configs/transformer_baseline_config.yml

[32m[2025-11-19 14:13:03]    INFO >> Loading config from /home/zhaojunzhang/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools/temp_configs/transformer_baseline_config.yml (train_enhanced.py:477, cli_main())[0m
[32m[2025-11-19 14:13:03]    INFO >> Single GPU training... (train_enhanced.py:507, cli_main())[0m
[TrainingLogger] Êó•ÂøóÁõÆÂΩï: /mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/baseline
[TrainingLogger] ÂéüÂßãËæìÂá∫‰øùÂ≠òËá≥: /mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/baseline/training_output.log
[32m[2025-11-19 14:13:03]    INFO >> {'bpe': None, 'checkpoint': {'best_checkpoint_metric': 'loss', 'cache_dir': None, 'keep_best_checkpoints': -1, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'logging_steps': 500, 'maximize_best_checkpoint_metric': 0, 'model_name_or_path': None, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save': 0, 'no_save_optimizer_state': None, 'optimizer_overrides': '{}', 'overwrite_cache': 0, 'overwrite_output_dir': 0, 'patience': 3, 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'restore_file': 'checkpoint_last.pt', 'save_dir': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/baseline', 'save_interval': 1, 'save_interval_updates': 0, 'save_steps': 2000, 'save_total_limit': 2, 'should_continue': 0}, 'common': {'bf16': 0, 'cpu': 0, 'empty_cache_freq': 0, 'fp16': 0, 'fp16_init_scale': 128, 'fp16_no_flatten_grads': 1, 'fp16_opt_level': '01', 'fp16_scale_tolerance': 0.0, 'fp16_scale_window': None, 'log_format': 'simple', 'log_interval': 50, 'memory_efficient_fp16': 0, 'min_loss_scale': 0.0001, 'no_progress_bar': 0, 'seed': 1, 'server_ip': '', 'server_port': '', 'task': 'typetransformer', 'tensorboard_logdir': '', 'threshold_loss_scale': None}, 'criterion': 'cross_entropy', 'dataset': {'curriculum': 0, 'dataset_impl': 'mmap', 'disable_validation': 0, 'fixed_validation_seed': None, 'gen_subset': 'test', 'max_sentences': 16, 'max_sentences_valid': 64, 'max_tokens': None, 'max_tokens_valid': None, 'num_shards': 1, 'num_workers': 0, 'required_batch_size_multiple': 8, 'shard_id': 0, 'skip_invalid_size_inputs_valid_test': 1, 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1}, 'distributed_training': {'average_sync': 0, 'block_lr': 1, 'block_momentum': 0.875, 'broadcast_buffers': 0, 'bucket_cap_mb': 25, 'ddp_backend': 'c10d', 'device_id': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_no_spawn': 0, 'distributed_port': -1, 'distributed_rank': 0, 'distributed_world_size': 1, 'fast_stat_sync': 0, 'find_unused_parameters': 0, 'fix_batches_to_gpus': None, 'global_sync_iter': 50, 'local_rank': -1, 'use_nbm': 0, 'warmup_iterations': 500}, 'eval': {'beam': 1, 'decoding_format': None, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_force_max_iter': 0, 'iter_decode_max_iter': 10, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': 0, 'lenpen': 1, 'match_source_len': 0, 'max_len_a': 0, 'max_len_b': 512, 'max_sentences': 256, 'min_len': 1, 'model_overrides': '{}', 'nbest': 1, 'nltk_bleu': 0, 'no_beamable_mm': 0, 'no_early_stop': 0, 'no_repeat_ngram_size': 0, 'path': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/base/checkpoint_best.pt', 'prefix_size': 0, 'print_alignment': 0, 'print_step': 0, 'quiet': 0, 'remove_bpe': None, 'replace_unk': None, 'result_path': None, 'retain_iter_history': 0, 'rouge': 0, 'sacrebleu': 0, 'sampling': 0, 'sampling_topk': -1, 'sampling_topp': -1, 'score_reference': 0, 'temperature': 1.0, 'unkpen': 0, 'unnormalized': 0}, 'lr_scheduler': 'fixed', 'model': {'activation': 'relu', 'arch': 'typetransformer', 'd_ff': 1024, 'd_model': 256, 'd_rep': 128, 'dropout': 0.1, 'encoder_type': 'transformer', 'max_positions': 512, 'n_encoder_layers': 4, 'n_head': 8}, 'optimization': {'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'use_old_adam': 0, 'weight_decay': 0.01}, 'clip_norm': 25, 'force_anneal': 0, 'lr_shrink': 0.98, 'lrs': [0.0001], 'max_epoch': 50, 'max_update': 0, 'min_lr': 1e-06, 'sentence_avg': 1, 'update_freq': [1], 'use_bmuf': 0, 'warmup_updates': 2000}, 'optimizer': 'torch_adam', 'task': {'data': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/data-mmap', 'left_pad_source': 0, 'left_pad_target': 0, 'load_alignments': 0, 'max_source_positions': 512, 'max_target_positions': 512, 'source_langs': ['token-sequence'], 'target_langs': ['supernodes'], 'tokens_per_sample': 512, 'truncate_source': 1, 'truncate_target': 0, 'upsample_primary': 1}, 'tokenizer': None} (train_enhanced.py:375, single_main())[0m
Traceback (most recent call last):
  File "train_enhanced.py", line 519, in <module>
    cli_main()
  File "train_enhanced.py", line 508, in cli_main
    single_main(args_dict)
  File "train_enhanced.py", line 379, in single_main
    task = tasks.setup_task(args)
  File "/home/zhaojunzhang/workspace/type_pred/naturalcc/ncc/tasks/__init__.py", line 15, in setup_task
    return TASK_REGISTRY[args['common']['task']].setup_task(args, **kwargs)
KeyError: 'typetransformer'

ÂÆûÈ™å transformer_baseline Â§±Ë¥•
ÈîôËØØ: Command '['/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/bin/python', 'train_enhanced.py', '--config', 'temp_configs/transformer_baseline_config.yml']' returned non-zero exit status 1.

================================================================================
ÂÆûÈ™å: transformer_lr_5e5
ÊèèËø∞: Â≠¶‰π†Áéá 5e-5
================================================================================

ÈÖçÁΩÆÊñá‰ª∂: temp_configs/transformer_lr_5e5_config.yml
ÂëΩ‰ª§: /mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/bin/python train_enhanced.py --config temp_configs/transformer_lr_5e5_config.yml

[32m[2025-11-19 14:13:05]    INFO >> Loading config from /home/zhaojunzhang/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools/temp_configs/transformer_lr_5e5_config.yml (train_enhanced.py:477, cli_main())[0m
^[[A[32m[2025-11-19 14:13:05]    INFO >> Single GPU training... (train_enhanced.py:507, cli_main())[0m
[TrainingLogger] Êó•ÂøóÁõÆÂΩï: /mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/lr_5e5
[TrainingLogger] ÂéüÂßãËæìÂá∫‰øùÂ≠òËá≥: /mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/lr_5e5/training_output.log
[32m[2025-11-19 14:13:05]    INFO >> {'bpe': None, 'checkpoint': {'best_checkpoint_metric': 'loss', 'cache_dir': None, 'keep_best_checkpoints': -1, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'logging_steps': 500, 'maximize_best_checkpoint_metric': 0, 'model_name_or_path': None, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save': 0, 'no_save_optimizer_state': None, 'optimizer_overrides': '{}', 'overwrite_cache': 0, 'overwrite_output_dir': 0, 'patience': 3, 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'restore_file': 'checkpoint_last.pt', 'save_dir': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/lr_5e5', 'save_interval': 1, 'save_interval_updates': 0, 'save_steps': 2000, 'save_total_limit': 2, 'should_continue': 0}, 'common': {'bf16': 0, 'cpu': 0, 'empty_cache_freq': 0, 'fp16': 0, 'fp16_init_scale': 128, 'fp16_no_flatten_grads': 1, 'fp16_opt_level': '01', 'fp16_scale_tolerance': 0.0, 'fp16_scale_window': None, 'log_format': 'simple', 'log_interval': 50, 'memory_efficient_fp16': 0, 'min_loss_scale': 0.0001, 'no_progress_bar': 0, 'seed': 1, 'server_ip': '', 'server_port': '', 'task': 'typetransformer', 'tensorboard_logdir': '', 'threshold_loss_scale': None}, 'criterion': 'cross_entropy', 'dataset': {'curriculum': 0, 'dataset_impl': 'mmap', 'disable_validation': 0, 'fixed_validation_seed': None, 'gen_subset': 'test', 'max_sentences': 16, 'max_sentences_valid': 64, 'max_tokens': None, 'max_tokens_valid': None, 'num_shards': 1, 'num_workers': 0, 'required_batch_size_multiple': 8, 'shard_id': 0, 'skip_invalid_size_inputs_valid_test': 1, 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1}, 'distributed_training': {'average_sync': 0, 'block_lr': 1, 'block_momentum': 0.875, 'broadcast_buffers': 0, 'bucket_cap_mb': 25, 'ddp_backend': 'c10d', 'device_id': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_no_spawn': 0, 'distributed_port': -1, 'distributed_rank': 0, 'distributed_world_size': 1, 'fast_stat_sync': 0, 'find_unused_parameters': 0, 'fix_batches_to_gpus': None, 'global_sync_iter': 50, 'local_rank': -1, 'use_nbm': 0, 'warmup_iterations': 500}, 'eval': {'beam': 1, 'decoding_format': None, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_force_max_iter': 0, 'iter_decode_max_iter': 10, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': 0, 'lenpen': 1, 'match_source_len': 0, 'max_len_a': 0, 'max_len_b': 512, 'max_sentences': 256, 'min_len': 1, 'model_overrides': '{}', 'nbest': 1, 'nltk_bleu': 0, 'no_beamable_mm': 0, 'no_early_stop': 0, 'no_repeat_ngram_size': 0, 'path': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/base/checkpoint_best.pt', 'prefix_size': 0, 'print_alignment': 0, 'print_step': 0, 'quiet': 0, 'remove_bpe': None, 'replace_unk': None, 'result_path': None, 'retain_iter_history': 0, 'rouge': 0, 'sacrebleu': 0, 'sampling': 0, 'sampling_topk': -1, 'sampling_topp': -1, 'score_reference': 0, 'temperature': 1.0, 'unkpen': 0, 'unnormalized': 0}, 'lr_scheduler': 'fixed', 'model': {'activation': 'relu', 'arch': 'typetransformer', 'd_ff': 1024, 'd_model': 256, 'd_rep': 128, 'dropout': 0.1, 'encoder_type': 'transformer', 'max_positions': 512, 'n_encoder_layers': 4, 'n_head': 8}, 'optimization': {'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'use_old_adam': 0, 'weight_decay': 0.01}, 'clip_norm': 25, 'force_anneal': 0, 'lr_shrink': 0.98, 'lrs': [5e-05], 'max_epoch': 50, 'max_update': 0, 'min_lr': 1e-06, 'sentence_avg': 1, 'update_freq': [1], 'use_bmuf': 0, 'warmup_updates': 2000}, 'optimizer': 'torch_adam', 'task': {'data': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/data-mmap', 'left_pad_source': 0, 'left_pad_target': 0, 'load_alignments': 0, 'max_source_positions': 512, 'max_target_positions': 512, 'source_langs': ['token-sequence'], 'target_langs': ['supernodes'], 'tokens_per_sample': 512, 'truncate_source': 1, 'truncate_target': 0, 'upsample_primary': 1}, 'tokenizer': None} (train_enhanced.py:375, single_main())[0m
Traceback (most recent call last):
  File "train_enhanced.py", line 519, in <module>
    cli_main()
  File "train_enhanced.py", line 508, in cli_main
    single_main(args_dict)
  File "train_enhanced.py", line 379, in single_main
    task = tasks.setup_task(args)
  File "/home/zhaojunzhang/workspace/type_pred/naturalcc/ncc/tasks/__init__.py", line 15, in setup_task
    return TASK_REGISTRY[args['common']['task']].setup_task(args, **kwargs)
KeyError: 'typetransformer'
^[[A
ÂÆûÈ™å transformer_lr_5e5 Â§±Ë¥•
ÈîôËØØ: Command '['/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/bin/python', 'train_enhanced.py', '--config', 'temp_configs/transformer_lr_5e5_config.yml']' returned non-zero exit status 1.

================================================================================
ÂÆûÈ™å: transformer_lr_7p5e5
ÊèèËø∞: Â≠¶‰π†Áéá 7.5e-5
================================================================================

ÈÖçÁΩÆÊñá‰ª∂: temp_configs/transformer_lr_7p5e5_config.yml
ÂëΩ‰ª§: /mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/bin/python train_enhanced.py --config temp_configs/transformer_lr_7p5e5_config.yml

^[[A^[[A^[[B^[[B^[[B^[[B^[[B[32m[2025-11-19 14:13:07]    INFO >> Loading config from /home/zhaojunzhang/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools/temp_configs/transformer_lr_7p5e5_config.yml (train_enhanced.py:477, cli_main())[0m
[32m[2025-11-19 14:13:07]    INFO >> Single GPU training... (train_enhanced.py:507, cli_main())[0m
[TrainingLogger] Êó•ÂøóÁõÆÂΩï: /mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/lr_7p5e5
[TrainingLogger] ÂéüÂßãËæìÂá∫‰øùÂ≠òËá≥: /mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/lr_7p5e5/training_output.log
[32m[2025-11-19 14:13:07]    INFO >> {'bpe': None, 'checkpoint': {'best_checkpoint_metric': 'loss', 'cache_dir': None, 'keep_best_checkpoints': -1, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'logging_steps': 500, 'maximize_best_checkpoint_metric': 0, 'model_name_or_path': None, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save': 0, 'no_save_optimizer_state': None, 'optimizer_overrides': '{}', 'overwrite_cache': 0, 'overwrite_output_dir': 0, 'patience': 3, 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'restore_file': 'checkpoint_last.pt', 'save_dir': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/lr_7p5e5', 'save_interval': 1, 'save_interval_updates': 0, 'save_steps': 2000, 'save_total_limit': 2, 'should_continue': 0}, 'common': {'bf16': 0, 'cpu': 0, 'empty_cache_freq': 0, 'fp16': 0, 'fp16_init_scale': 128, 'fp16_no_flatten_grads': 1, 'fp16_opt_level': '01', 'fp16_scale_tolerance': 0.0, 'fp16_scale_window': None, 'log_format': 'simple', 'log_interval': 50, 'memory_efficient_fp16': 0, 'min_loss_scale': 0.0001, 'no_progress_bar': 0, 'seed': 1, 'server_ip': '', 'server_port': '', 'task': 'typetransformer', 'tensorboard_logdir': '', 'threshold_loss_scale': None}, 'criterion': 'cross_entropy', 'dataset': {'curriculum': 0, 'dataset_impl': 'mmap', 'disable_validation': 0, 'fixed_validation_seed': None, 'gen_subset': 'test', 'max_sentences': 16, 'max_sentences_valid': 64, 'max_tokens': None, 'max_tokens_valid': None, 'num_shards': 1, 'num_workers': 0, 'required_batch_size_multiple': 8, 'shard_id': 0, 'skip_invalid_size_inputs_valid_test': 1, 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1}, 'distributed_training': {'average_sync': 0, 'block_lr': 1, 'block_momentum': 0.875, 'broadcast_buffers': 0, 'bucket_cap_mb': 25, 'ddp_backend': 'c10d', 'device_id': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_no_spawn': 0, 'distributed_port': -1, 'distributed_rank': 0, 'distributed_world_size': 1, 'fast_stat_sync': 0, 'find_unused_parameters': 0, 'fix_batches_to_gpus': None, 'global_sync_iter': 50, 'local_rank': -1, 'use_nbm': 0, 'warmup_iterations': 500}, 'eval': {'beam': 1, 'decoding_format': None, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_force_max_iter': 0, 'iter_decode_max_iter': 10, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': 0, 'lenpen': 1, 'match_source_len': 0, 'max_len_a': 0, 'max_len_b': 512, 'max_sentences': 256, 'min_len': 1, 'model_overrides': '{}', 'nbest': 1, 'nltk_bleu': 0, 'no_beamable_mm': 0, 'no_early_stop': 0, 'no_repeat_ngram_size': 0, 'path': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/base/checkpoint_best.pt', 'prefix_size': 0, 'print_alignment': 0, 'print_step': 0, 'quiet': 0, 'remove_bpe': None, 'replace_unk': None, 'result_path': None, 'retain_iter_history': 0, 'rouge': 0, 'sacrebleu': 0, 'sampling': 0, 'sampling_topk': -1, 'sampling_topp': -1, 'score_reference': 0, 'temperature': 1.0, 'unkpen': 0, 'unnormalized': 0}, 'lr_scheduler': 'fixed', 'model': {'activation': 'relu', 'arch': 'typetransformer', 'd_ff': 1024, 'd_model': 256, 'd_rep': 128, 'dropout': 0.1, 'encoder_type': 'transformer', 'max_positions': 512, 'n_encoder_layers': 4, 'n_head': 8}, 'optimization': {'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'use_old_adam': 0, 'weight_decay': 0.01}, 'clip_norm': 25, 'force_anneal': 0, 'lr_shrink': 0.98, 'lrs': [7.5e-05], 'max_epoch': 50, 'max_update': 0, 'min_lr': 1e-06, 'sentence_avg': 1, 'update_freq': [1], 'use_bmuf': 0, 'warmup_updates': 2000}, 'optimizer': 'torch_adam', 'task': {'data': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/data-mmap', 'left_pad_source': 0, 'left_pad_target': 0, 'load_alignments': 0, 'max_source_positions': 512, 'max_target_positions': 512, 'source_langs': ['token-sequence'], 'target_langs': ['supernodes'], 'tokens_per_sample': 512, 'truncate_source': 1, 'truncate_target': 0, 'upsample_primary': 1}, 'tokenizer': None} (train_enhanced.py:375, single_main())[0m
Traceback (most recent call last):
  File "train_enhanced.py", line 519, in <module>
    cli_main()
  File "train_enhanced.py", line 508, in cli_main
    single_main(args_dict)
  File "train_enhanced.py", line 379, in single_main
    task = tasks.setup_task(args)
  File "/home/zhaojunzhang/workspace/type_pred/naturalcc/ncc/tasks/__init__.py", line 15, in setup_task
    return TASK_REGISTRY[args['common']['task']].setup_task(args, **kwargs)
KeyError: 'typetransformer'

ÂÆûÈ™å transformer_lr_7p5e5 Â§±Ë¥•
ÈîôËØØ: Command '['/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/bin/python', 'train_enhanced.py', '--config', 'temp_configs/transformer_lr_7p5e5_config.yml']' returned non-zero exit status 1.

================================================================================
ÂÆûÈ™å: transformer_lr_1e4
ÊèèËø∞: Â≠¶‰π†Áéá 1e-4 (baselineÈáçÂ§çÈ™åËØÅ)
================================================================================

ÈÖçÁΩÆÊñá‰ª∂: temp_configs/transformer_lr_1e4_config.yml
ÂëΩ‰ª§: /mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/bin/python train_enhanced.py --config temp_configs/transformer_lr_1e4_config.yml

^CTraceback (most recent call last):
  File "train_enhanced.py", line 22, in <module>
    from ncc import tasks
  File "/home/zhaojunzhang/workspace/type_pred/naturalcc/ncc/tasks/__init__.py", line 70, in <module>
    importlib.import_module('ncc.tasks.' + task_name)
  File "/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/home/zhaojunzhang/workspace/type_pred/naturalcc/ncc/tasks/summarization/__init__.py", line 1, in <module>
    from .summarization import SummarizationTask
  File "/home/zhaojunzhang/workspace/type_pred/naturalcc/ncc/tasks/summarization/summarization.py", line 24, in <module>
    from ncc.eval.summarization import summarization_metrics
  File "/home/zhaojunzhang/workspace/type_pred/naturalcc/ncc/eval/summarization/summarization_metrics.py", line 7, in <module>
    from third_party.pycocoevalcap.bleu import corpus_bleu
  File "/home/zhaojunzhang/workspace/type_pred/naturalcc/third_party/pycocoevalcap/bleu/__init__.py", line 5, in <module>
    from .nltk_bleu import *
  File "/home/zhaojunzhang/workspace/type_pred/naturalcc/third_party/pycocoevalcap/bleu/nltk_bleu.py", line 1, in <module>
    import nltk
  File "/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/lib/python3.8/site-packages/nltk/__init__.py", line 133, in <module>
    from nltk.collocations import *
  File "/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/lib/python3.8/site-packages/nltk/collocations.py", line 36, in <module>
    from nltk.metrics import (
  File "/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/lib/python3.8/site-packages/nltk/metrics/__init__.py", line 18, in <module>
    from nltk.metrics.association import (
  File "/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/lib/python3.8/site-packages/nltk/metrics/association.py", line 26, in <module>
    from scipy.stats import fisher_exact
  File "/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/lib/python3.8/site-packages/scipy/stats/__init__.py", line 485, in <module>
    from ._stats_py import *
  File "/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/lib/python3.8/site-packages/scipy/stats/_stats_py.py", line 46, in <module>
    from . import distributions
  File "/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/lib/python3.8/site-packages/scipy/stats/distributions.py", line 10, in <module>
    from . import _continuous_distns
  File "/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/lib/python3.8/site-packages/scipy/stats/_continuous_distns.py", line 6376, in <module>
    moyal = moyal_gen(name="moyal")
  File "/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/lib/python3.8/site-packages/scipy/stats/_distn_infrastructure.py", line 1954, in __init__
    self._construct_doc(docdict, dct.get(self.name))
  File "/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/lib/python3.8/site-packages/scipy/stats/_distn_infrastructure.py", line 792, in _construct_doc
    self.__doc__ = self.__doc__.replace('(, ', '(').replace(', )', ')')
KeyboardInterrupt

ÂÆûÈ™å transformer_lr_1e4 Ë¢´Áî®Êà∑‰∏≠Êñ≠

================================================================================
ÂÆûÈ™å: transformer_lr_2e4
ÊèèËø∞: Â≠¶‰π†Áéá 2e-4
================================================================================

ÈÖçÁΩÆÊñá‰ª∂: temp_configs/transformer_lr_2e4_config.yml
ÂëΩ‰ª§: /mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/bin/python train_enhanced.py --config temp_configs/transformer_lr_2e4_config.yml

^[[A^[[A^[[A^[[A[32m[2025-11-19 14:13:11]    INFO >> Loading config from /home/zhaojunzhang/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools/temp_configs/transformer_lr_2e4_config.yml (train_enhanced.py:477, cli_main())[0m
[32m[2025-11-19 14:13:11]    INFO >> Single GPU training... (train_enhanced.py:507, cli_main())[0m
[TrainingLogger] Êó•ÂøóÁõÆÂΩï: /mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/lr_2e4
[TrainingLogger] ÂéüÂßãËæìÂá∫‰øùÂ≠òËá≥: /mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/lr_2e4/training_output.log
[32m[2025-11-19 14:13:12]    INFO >> {'bpe': None, 'checkpoint': {'best_checkpoint_metric': 'loss', 'cache_dir': None, 'keep_best_checkpoints': -1, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'logging_steps': 500, 'maximize_best_checkpoint_metric': 0, 'model_name_or_path': None, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save': 0, 'no_save_optimizer_state': None, 'optimizer_overrides': '{}', 'overwrite_cache': 0, 'overwrite_output_dir': 0, 'patience': 3, 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'restore_file': 'checkpoint_last.pt', 'save_dir': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/lr_2e4', 'save_interval': 1, 'save_interval_updates': 0, 'save_steps': 2000, 'save_total_limit': 2, 'should_continue': 0}, 'common': {'bf16': 0, 'cpu': 0, 'empty_cache_freq': 0, 'fp16': 0, 'fp16_init_scale': 128, 'fp16_no_flatten_grads': 1, 'fp16_opt_level': '01', 'fp16_scale_tolerance': 0.0, 'fp16_scale_window': None, 'log_format': 'simple', 'log_interval': 50, 'memory_efficient_fp16': 0, 'min_loss_scale': 0.0001, 'no_progress_bar': 0, 'seed': 1, 'server_ip': '', 'server_port': '', 'task': 'typetransformer', 'tensorboard_logdir': '', 'threshold_loss_scale': None}, 'criterion': 'cross_entropy', 'dataset': {'curriculum': 0, 'dataset_impl': 'mmap', 'disable_validation': 0, 'fixed_validation_seed': None, 'gen_subset': 'test', 'max_sentences': 16, 'max_sentences_valid': 64, 'max_tokens': None, 'max_tokens_valid': None, 'num_shards': 1, 'num_workers': 0, 'required_batch_size_multiple': 8, 'shard_id': 0, 'skip_invalid_size_inputs_valid_test': 1, 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1}, 'distributed_training': {'average_sync': 0, 'block_lr': 1, 'block_momentum': 0.875, 'broadcast_buffers': 0, 'bucket_cap_mb': 25, 'ddp_backend': 'c10d', 'device_id': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_no_spawn': 0, 'distributed_port': -1, 'distributed_rank': 0, 'distributed_world_size': 1, 'fast_stat_sync': 0, 'find_unused_parameters': 0, 'fix_batches_to_gpus': None, 'global_sync_iter': 50, 'local_rank': -1, 'use_nbm': 0, 'warmup_iterations': 500}, 'eval': {'beam': 1, 'decoding_format': None, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_force_max_iter': 0, 'iter_decode_max_iter': 10, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': 0, 'lenpen': 1, 'match_source_len': 0, 'max_len_a': 0, 'max_len_b': 512, 'max_sentences': 256, 'min_len': 1, 'model_overrides': '{}', 'nbest': 1, 'nltk_bleu': 0, 'no_beamable_mm': 0, 'no_early_stop': 0, 'no_repeat_ngram_size': 0, 'path': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/base/checkpoint_best.pt', 'prefix_size': 0, 'print_alignment': 0, 'print_step': 0, 'quiet': 0, 'remove_bpe': None, 'replace_unk': None, 'result_path': None, 'retain_iter_history': 0, 'rouge': 0, 'sacrebleu': 0, 'sampling': 0, 'sampling_topk': -1, 'sampling_topp': -1, 'score_reference': 0, 'temperature': 1.0, 'unkpen': 0, 'unnormalized': 0}, 'lr_scheduler': 'fixed', 'model': {'activation': 'relu', 'arch': 'typetransformer', 'd_ff': 1024, 'd_model': 256, 'd_rep': 128, 'dropout': 0.1, 'encoder_type': 'transformer', 'max_positions': 512, 'n_encoder_layers': 4, 'n_head': 8}, 'optimization': {'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'use_old_adam': 0, 'weight_decay': 0.01}, 'clip_norm': 25, 'force_anneal': 0, 'lr_shrink': 0.98, 'lrs': [0.0002], 'max_epoch': 50, 'max_update': 0, 'min_lr': 1e-06, 'sentence_avg': 1, 'update_freq': [1], 'use_bmuf': 0, 'warmup_updates': 2000}, 'optimizer': 'torch_adam', 'task': {'data': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/data-mmap', 'left_pad_source': 0, 'left_pad_target': 0, 'load_alignments': 0, 'max_source_positions': 512, 'max_target_positions': 512, 'source_langs': ['token-sequence'], 'target_langs': ['supernodes'], 'tokens_per_sample': 512, 'truncate_source': 1, 'truncate_target': 0, 'upsample_primary': 1}, 'tokenizer': None} (train_enhanced.py:375, single_main())[0m
Traceback (most recent call last):
  File "train_enhanced.py", line 519, in <module>
    cli_main()
  File "train_enhanced.py", line 508, in cli_main
    single_main(args_dict)
  File "train_enhanced.py", line 379, in single_main
    task = tasks.setup_task(args)
  File "/home/zhaojunzhang/workspace/type_pred/naturalcc/ncc/tasks/__init__.py", line 15, in setup_task
    return TASK_REGISTRY[args['common']['task']].setup_task(args, **kwargs)
KeyError: 'typetransformer'

ÂÆûÈ™å transformer_lr_2e4 Â§±Ë¥•
ÈîôËØØ: Command '['/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/bin/python', 'train_enhanced.py', '--config', 'temp_configs/transformer_lr_2e4_config.yml']' returned non-zero exit status 1.

================================================================================
ÂÆûÈ™å: transformer_deep
ÊèèËø∞: Êõ¥Ê∑±ÁöÑTransformer (6Â±Ç)
================================================================================

ÈÖçÁΩÆÊñá‰ª∂: temp_configs/transformer_deep_config.yml
ÂëΩ‰ª§: /mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/bin/python train_enhanced.py --config temp_configs/transformer_deep_config.yml

[32m[2025-11-19 14:13:14]    INFO >> Loading config from /home/zhaojunzhang/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools/temp_configs/transformer_deep_config.yml (train_enhanced.py:477, cli_main())[0m
[32m[2025-11-19 14:13:14]    INFO >> Single GPU training... (train_enhanced.py:507, cli_main())[0m
[TrainingLogger] Êó•ÂøóÁõÆÂΩï: /mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/deep
[TrainingLogger] ÂéüÂßãËæìÂá∫‰øùÂ≠òËá≥: /mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/deep/training_output.log
[32m[2025-11-19 14:13:14]    INFO >> {'bpe': None, 'checkpoint': {'best_checkpoint_metric': 'loss', 'cache_dir': None, 'keep_best_checkpoints': -1, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'logging_steps': 500, 'maximize_best_checkpoint_metric': 0, 'model_name_or_path': None, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save': 0, 'no_save_optimizer_state': None, 'optimizer_overrides': '{}', 'overwrite_cache': 0, 'overwrite_output_dir': 0, 'patience': 3, 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'restore_file': 'checkpoint_last.pt', 'save_dir': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/deep', 'save_interval': 1, 'save_interval_updates': 0, 'save_steps': 2000, 'save_total_limit': 2, 'should_continue': 0}, 'common': {'bf16': 0, 'cpu': 0, 'empty_cache_freq': 0, 'fp16': 0, 'fp16_init_scale': 128, 'fp16_no_flatten_grads': 1, 'fp16_opt_level': '01', 'fp16_scale_tolerance': 0.0, 'fp16_scale_window': None, 'log_format': 'simple', 'log_interval': 50, 'memory_efficient_fp16': 0, 'min_loss_scale': 0.0001, 'no_progress_bar': 0, 'seed': 1, 'server_ip': '', 'server_port': '', 'task': 'typetransformer', 'tensorboard_logdir': '', 'threshold_loss_scale': None}, 'criterion': 'cross_entropy', 'dataset': {'curriculum': 0, 'dataset_impl': 'mmap', 'disable_validation': 0, 'fixed_validation_seed': None, 'gen_subset': 'test', 'max_sentences': 16, 'max_sentences_valid': 64, 'max_tokens': None, 'max_tokens_valid': None, 'num_shards': 1, 'num_workers': 0, 'required_batch_size_multiple': 8, 'shard_id': 0, 'skip_invalid_size_inputs_valid_test': 1, 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1}, 'distributed_training': {'average_sync': 0, 'block_lr': 1, 'block_momentum': 0.875, 'broadcast_buffers': 0, 'bucket_cap_mb': 25, 'ddp_backend': 'c10d', 'device_id': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_no_spawn': 0, 'distributed_port': -1, 'distributed_rank': 0, 'distributed_world_size': 1, 'fast_stat_sync': 0, 'find_unused_parameters': 0, 'fix_batches_to_gpus': None, 'global_sync_iter': 50, 'local_rank': -1, 'use_nbm': 0, 'warmup_iterations': 500}, 'eval': {'beam': 1, 'decoding_format': None, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_force_max_iter': 0, 'iter_decode_max_iter': 10, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': 0, 'lenpen': 1, 'match_source_len': 0, 'max_len_a': 0, 'max_len_b': 512, 'max_sentences': 256, 'min_len': 1, 'model_overrides': '{}', 'nbest': 1, 'nltk_bleu': 0, 'no_beamable_mm': 0, 'no_early_stop': 0, 'no_repeat_ngram_size': 0, 'path': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/base/checkpoint_best.pt', 'prefix_size': 0, 'print_alignment': 0, 'print_step': 0, 'quiet': 0, 'remove_bpe': None, 'replace_unk': None, 'result_path': None, 'retain_iter_history': 0, 'rouge': 0, 'sacrebleu': 0, 'sampling': 0, 'sampling_topk': -1, 'sampling_topp': -1, 'score_reference': 0, 'temperature': 1.0, 'unkpen': 0, 'unnormalized': 0}, 'lr_scheduler': 'fixed', 'model': {'activation': 'relu', 'arch': 'typetransformer', 'd_ff': 1024, 'd_model': 256, 'd_rep': 128, 'dropout': 0.1, 'encoder_type': 'transformer', 'max_positions': 512, 'n_encoder_layers': 6, 'n_head': 8}, 'optimization': {'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'use_old_adam': 0, 'weight_decay': 0.01}, 'clip_norm': 25, 'force_anneal': 0, 'lr_shrink': 0.98, 'lrs': [0.0001], 'max_epoch': 50, 'max_update': 0, 'min_lr': 1e-06, 'sentence_avg': 1, 'update_freq': [1], 'use_bmuf': 0, 'warmup_updates': 2000}, 'optimizer': 'torch_adam', 'task': {'data': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/data-mmap', 'left_pad_source': 0, 'left_pad_target': 0, 'load_alignments': 0, 'max_source_positions': 512, 'max_target_positions': 512, 'source_langs': ['token-sequence'], 'target_langs': ['supernodes'], 'tokens_per_sample': 512, 'truncate_source': 1, 'truncate_target': 0, 'upsample_primary': 1}, 'tokenizer': None} (train_enhanced.py:375, single_main())[0m
Traceback (most recent call last):
  File "train_enhanced.py", line 519, in <module>
    cli_main()
  File "train_enhanced.py", line 508, in cli_main
    single_main(args_dict)
  File "train_enhanced.py", line 379, in single_main
    task = tasks.setup_task(args)
  File "/home/zhaojunzhang/workspace/type_pred/naturalcc/ncc/tasks/__init__.py", line 15, in setup_task
    return TASK_REGISTRY[args['common']['task']].setup_task(args, **kwargs)
KeyError: 'typetransformer'

ÂÆûÈ™å transformer_deep Â§±Ë¥•
ÈîôËØØ: Command '['/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/bin/python', 'train_enhanced.py', '--config', 'temp_configs/transformer_deep_config.yml']' returned non-zero exit status 1.

================================================================================
ÂÆûÈ™å: transformer_wide
ÊèèËø∞: Êõ¥ÂÆΩÁöÑTransformer (d_model=512)
================================================================================

ÈÖçÁΩÆÊñá‰ª∂: temp_configs/transformer_wide_config.yml
ÂëΩ‰ª§: /mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/bin/python train_enhanced.py --config temp_configs/transformer_wide_config.yml

[32m[2025-11-19 14:13:16]    INFO >> Loading config from /home/zhaojunzhang/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools/temp_configs/transformer_wide_config.yml (train_enhanced.py:477, cli_main())[0m
[32m[2025-11-19 14:13:16]    INFO >> Single GPU training... (train_enhanced.py:507, cli_main())[0m
[TrainingLogger] Êó•ÂøóÁõÆÂΩï: /mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/wide
[TrainingLogger] ÂéüÂßãËæìÂá∫‰øùÂ≠òËá≥: /mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/wide/training_output.log
[32m[2025-11-19 14:13:16]    INFO >> {'bpe': None, 'checkpoint': {'best_checkpoint_metric': 'loss', 'cache_dir': None, 'keep_best_checkpoints': -1, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'logging_steps': 500, 'maximize_best_checkpoint_metric': 0, 'model_name_or_path': None, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save': 0, 'no_save_optimizer_state': None, 'optimizer_overrides': '{}', 'overwrite_cache': 0, 'overwrite_output_dir': 0, 'patience': 3, 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'restore_file': 'checkpoint_last.pt', 'save_dir': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/wide', 'save_interval': 1, 'save_interval_updates': 0, 'save_steps': 2000, 'save_total_limit': 2, 'should_continue': 0}, 'common': {'bf16': 0, 'cpu': 0, 'empty_cache_freq': 0, 'fp16': 0, 'fp16_init_scale': 128, 'fp16_no_flatten_grads': 1, 'fp16_opt_level': '01', 'fp16_scale_tolerance': 0.0, 'fp16_scale_window': None, 'log_format': 'simple', 'log_interval': 50, 'memory_efficient_fp16': 0, 'min_loss_scale': 0.0001, 'no_progress_bar': 0, 'seed': 1, 'server_ip': '', 'server_port': '', 'task': 'typetransformer', 'tensorboard_logdir': '', 'threshold_loss_scale': None}, 'criterion': 'cross_entropy', 'dataset': {'curriculum': 0, 'dataset_impl': 'mmap', 'disable_validation': 0, 'fixed_validation_seed': None, 'gen_subset': 'test', 'max_sentences': 16, 'max_sentences_valid': 64, 'max_tokens': None, 'max_tokens_valid': None, 'num_shards': 1, 'num_workers': 0, 'required_batch_size_multiple': 8, 'shard_id': 0, 'skip_invalid_size_inputs_valid_test': 1, 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1}, 'distributed_training': {'average_sync': 0, 'block_lr': 1, 'block_momentum': 0.875, 'broadcast_buffers': 0, 'bucket_cap_mb': 25, 'ddp_backend': 'c10d', 'device_id': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_no_spawn': 0, 'distributed_port': -1, 'distributed_rank': 0, 'distributed_world_size': 1, 'fast_stat_sync': 0, 'find_unused_parameters': 0, 'fix_batches_to_gpus': None, 'global_sync_iter': 50, 'local_rank': -1, 'use_nbm': 0, 'warmup_iterations': 500}, 'eval': {'beam': 1, 'decoding_format': None, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_force_max_iter': 0, 'iter_decode_max_iter': 10, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': 0, 'lenpen': 1, 'match_source_len': 0, 'max_len_a': 0, 'max_len_b': 512, 'max_sentences': 256, 'min_len': 1, 'model_overrides': '{}', 'nbest': 1, 'nltk_bleu': 0, 'no_beamable_mm': 0, 'no_early_stop': 0, 'no_repeat_ngram_size': 0, 'path': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/run/type_prediction/transformer/checkpoints/base/checkpoint_best.pt', 'prefix_size': 0, 'print_alignment': 0, 'print_step': 0, 'quiet': 0, 'remove_bpe': None, 'replace_unk': None, 'result_path': None, 'retain_iter_history': 0, 'rouge': 0, 'sacrebleu': 0, 'sampling': 0, 'sampling_topk': -1, 'sampling_topp': -1, 'score_reference': 0, 'temperature': 1.0, 'unkpen': 0, 'unnormalized': 0}, 'lr_scheduler': 'fixed', 'model': {'activation': 'relu', 'arch': 'typetransformer', 'd_ff': 2048, 'd_model': 512, 'd_rep': 128, 'dropout': 0.1, 'encoder_type': 'transformer', 'max_positions': 512, 'n_encoder_layers': 4, 'n_head': 8}, 'optimization': {'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'use_old_adam': 0, 'weight_decay': 0.01}, 'clip_norm': 25, 'force_anneal': 0, 'lr_shrink': 0.98, 'lrs': [0.0001], 'max_epoch': 50, 'max_update': 0, 'min_lr': 1e-06, 'sentence_avg': 1, 'update_freq': [1], 'use_bmuf': 0, 'warmup_updates': 2000}, 'optimizer': 'torch_adam', 'task': {'data': '/mnt/data1/zhaojunzhang/typilus-data/workspace/type_pred/naturalcc/data-mmap', 'left_pad_source': 0, 'left_pad_target': 0, 'load_alignments': 0, 'max_source_positions': 512, 'max_target_positions': 512, 'source_langs': ['token-sequence'], 'target_langs': ['supernodes'], 'tokens_per_sample': 512, 'truncate_source': 1, 'truncate_target': 0, 'upsample_primary': 1}, 'tokenizer': None} (train_enhanced.py:375, single_main())[0m
Traceback (most recent call last):
  File "train_enhanced.py", line 519, in <module>
    cli_main()
  File "train_enhanced.py", line 508, in cli_main
    single_main(args_dict)
  File "train_enhanced.py", line 379, in single_main
    task = tasks.setup_task(args)
  File "/home/zhaojunzhang/workspace/type_pred/naturalcc/ncc/tasks/__init__.py", line 15, in setup_task
    return TASK_REGISTRY[args['common']['task']].setup_task(args, **kwargs)
KeyError: 'typetransformer'

ÂÆûÈ™å transformer_wide Â§±Ë¥•
ÈîôËØØ: Command '['/mnt/data1/zhaojunzhang/packages/anaconda3/envs/naturalcc/bin/python', 'train_enhanced.py', '--config', 'temp_configs/transformer_wide_config.yml']' returned non-zero exit status 1.

================================================================================
ÂÆûÈ™åËøêË°åÊÄªÁªì
================================================================================
‚úó transformer_baseline           failed
‚úó transformer_lr_5e5             failed
‚úó transformer_lr_7p5e5           failed
‚úó transformer_lr_1e4             interrupted
‚úó transformer_lr_2e4             failed
‚úó transformer_deep               failed
‚úó transformer_wide               failed
(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools[00m$ python run_experiments.py [C[C[C[C[C[C[C[C[C[6Pcd experiment_tools/[C[C[C[C[C[C[C[C[C[C[C[C/home/zhaojunzhang/workspace/type_pred/naturalcc/run/type_prediction/transformer[C[C[C[C[C[C[C[C[Cprintenv NCC[K[K[A(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools[00m$ printenv NCC[K[A(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools[00m$ printenv NCC[K[A(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools[00m$ printenv NCC[K[A(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools[00m$ printenv NCC[K[A(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools[00m$ printenv NCC[K[A(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools[00m$ printenv NCC[K[A(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools[00m$ printenv NCC[K[A(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools[00m$ printenv NCC[K[A(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools[00m$ printenv NCC[K[A(naturalcc) [01;32mzhaojunzhang@dlserver6-Super-Server[00m:[01;34m~/workspace/type_pred/naturalcc/run/type_prediction/transformer/experiment_tools[00m$ printenv NCC